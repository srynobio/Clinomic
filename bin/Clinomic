#!/usr/bin/perl
use strict;
use warnings;
use lib '/home/srynearson/GVF-Clin/lib';
use GVF::ClinBuilder;
use File::Basename;

use Data::Dumper;

our ($VERSION) = '0.01';

# obj building.
my $builder = GVF::ClinBuilder->new_with_options();

# build and capture gvf data.
my $feature = $builder->gvfParser;

# valadate file entered, required.
my $value = $builder->gvfValadate($feature);
if ( $$value <= $builder->get_percent) {
    die sprintf ("
    Reference sequence does not validate to %s%%,
    Check file or enter lower validate value.
    RESULTS: %s matches %5.2f%% to reference.\n\n", $builder->get_percent, $builder->get_file, $$value);
}


#$builder->hgvsProtCheck($feature);

#__END__

# check if features have gene annotations and return
my $geneGVF = $builder->gvfGeneFind($feature);

# build relationship to data in dbSNP and GeneDatabase.db
my $clin = $builder->gvfRelationBuild($geneGVF);


#print Dumper($clin);
#__END__

# section which allow you to term_switch.
if ($builder->need_switch){
    $feature = $builder->termUpdate($feature);    
}

# send clin data to be printed out as requested.
$builder->exporter($clin);


__END__
# At the moment a sqlite3 file is made but not populated with data
# may add feature back in.
my $file = basename($builder->get_file);
$file =~ s/()\.gvf/$1.db/;
system("rm $file");


